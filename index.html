<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Neo Air Hockey AI</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #000;
      color: white;
      font-family: 'Arial', sans-serif;
      text-align: center;
    }
    canvas {
      display: block;
      margin: auto;
      background: #111;
      border: 4px solid white;
      border-radius: 10px;
    }
    #scoreboard {
      position: absolute;
      top: 10px;
      width: 100%;
      font-size: 20px;
      font-weight: bold;
    }
    #timer {
      font-size: 18px;
      margin-top: 4px;
    }
    #restartBtn {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 10px 20px;
      font-size: 16px;
      background: #333;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    #music {
      display: none;
    }
  </style>
</head>
<body>

<div id="scoreboard">
  Player: <span id="playerScore">0</span> | AI: <span id="aiScore">0</span>
  <div id="timer">Time Left: <span id="timeLeft">60</span>s</div>
</div>

<canvas id="gameCanvas" width="360" height="640"></canvas>
<button id="restartBtn">ðŸ”„ Restart</button>
<audio id="music" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" autoplay loop></audio>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  let player = { x: canvas.width / 2, y: canvas.height - 50, radius: 30 };
  let ai = { x: canvas.width / 2, y: 50, radius: 30 };
  let puck = { x: canvas.width / 2, y: canvas.height / 2, radius: 15, dx: 3, dy: 3 };

  let playerScore = 0;
  let aiScore = 0;
  let gameTime = 60;
  let gameRunning = true;

  const playerScoreEl = document.getElementById("playerScore");
  const aiScoreEl = document.getElementById("aiScore");
  const timerEl = document.getElementById("timeLeft");

  function drawCircle(x, y, radius, color) {
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, Math.PI * 2);
    ctx.fillStyle = color;
    ctx.fill();
    ctx.closePath();
  }

  function drawCenterLine() {
    ctx.strokeStyle = "#555";
    ctx.setLineDash([5, 15]);
    ctx.beginPath();
    ctx.moveTo(0, canvas.height / 2);
    ctx.lineTo(canvas.width, canvas.height / 2);
    ctx.stroke();
    ctx.setLineDash([]);
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    drawCenterLine();

    // Draw player and AI paddles
    drawCircle(player.x, player.y, player.radius, "#0f0");
    drawCircle(ai.x, ai.y, ai.radius, "#f00");

    // Draw puck
    drawCircle(puck.x, puck.y, puck.radius, "white");

    if (!gameRunning) return;

    // Update puck position
    puck.x += puck.dx;
    puck.y += puck.dy;

    // Wall collision
    if (puck.x - puck.radius < 0 || puck.x + puck.radius > canvas.width) {
      puck.dx *= -1;
    }

    // Goal logic
    if (puck.y - puck.radius < 0) {
      playerScore++;
      resetPuck();
    } else if (puck.y + puck.radius > canvas.height) {
      aiScore++;
      resetPuck();
    }

    // Update AI position (harder AI)
    if (puck.y < canvas.height / 2) {
      if (puck.x < ai.x - 5) ai.x -= 4;
      else if (puck.x > ai.x + 5) ai.x += 4;
    }

    // Paddle collisions
    handleCollision(player);
    handleCollision(ai);

    // Update scoreboard
    playerScoreEl.textContent = playerScore;
    aiScoreEl.textContent = aiScore;

    requestAnimationFrame(draw);
  }

  function handleCollision(paddle) {
    let dx = puck.x - paddle.x;
    let dy = puck.y - paddle.y;
    let distance = Math.sqrt(dx * dx + dy * dy);
    if (distance < puck.radius + paddle.radius) {
      let angle = Math.atan2(dy, dx);
      puck.dx = Math.cos(angle) * 4;
      puck.dy = Math.sin(angle) * 4;
    }
  }

  function resetPuck() {
    puck.x = canvas.width / 2;
    puck.y = canvas.height / 2;
    puck.dx = (Math.random() > 0.5 ? 3 : -3);
    puck.dy = (Math.random() > 0.5 ? 3 : -3);
  }

  canvas.addEventListener("touchmove", function (e) {
    const touch = e.touches[0];
    let rect = canvas.getBoundingClientRect();
    let x = touch.clientX - rect.left;
    let y = touch.clientY - rect.top;
    if (y > canvas.height / 2) {
      player.x = x;
      player.y = y;
    }
  });

  document.getElementById("restartBtn").onclick = () => {
    playerScore = 0;
    aiScore = 0;
    gameTime = 60;
    gameRunning = true;
    resetPuck();
  };

  // Timer
  setInterval(() => {
    if (!gameRunning) return;
    gameTime--;
    timerEl.textContent = gameTime;
    if (gameTime <= 0) {
      gameRunning = false;
      alert(playerScore > aiScore ? "ðŸŽ‰ You Win!" : "ðŸ˜¢ AI Wins!");
    }
  }, 1000);

  // Start background music
  document.getElementById("music").play();

  draw();
</script>

</body>
</html>
