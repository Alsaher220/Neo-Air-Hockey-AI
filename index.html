<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Neo Air Hockey AI</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background-color: #111;
    }
    canvas {
      display: block;
      background-color: #004466;
    }
    #scoreboard {
      position: absolute;
      top: 10px;
      left: 10px;
      font-size: 18px;
      color: #fff;
      font-family: sans-serif;
    }
    #timer {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 18px;
      color: #fff;
      font-family: sans-serif;
    }
  </style>
</head>
<body>
  <div id="scoreboard">Player: 0 | AI: 0</div>
  <div id="timer">Time: 03:00</div>
  <canvas id="gameCanvas" width="800" height="400"></canvas>

  <!-- Sound effects -->
  <audio id="hitSound" src="https://www.fesliyanstudios.com/play-mp3/387" preload="auto"></audio>
  <audio id="goalSound" src="https://www.fesliyanstudios.com/play-mp3/6677" preload="auto"></audio>
  <audio id="bgMusic" src="https://www.fesliyanstudios.com/play-mp3/3874" autoplay loop preload="auto"></audio>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const hitSound = document.getElementById('hitSound');
    const goalSound = document.getElementById('goalSound');
    const bgMusic = document.getElementById('bgMusic');
    const scoreboard = document.getElementById('scoreboard');
    const timerDisplay = document.getElementById('timer');

    const width = canvas.width;
    const height = canvas.height;

    let playerScore = 0;
    let aiScore = 0;
    let gameTime = 180; // 3 minutes

    let puck = { x: width / 2, y: height / 2, radius: 10, dx: 4, dy: 4 };
    let player = { x: 50, y: height / 2, radius: 20 };
    let ai = { x: width - 50, y: height / 2, radius: 20 };

    document.addEventListener("mousemove", (e) => {
      const rect = canvas.getBoundingClientRect();
      player.y = e.clientY - rect.top;
    });

    function drawBoard() {
      ctx.fillStyle = '#004466';
      ctx.fillRect(0, 0, width, height);

      // Midline
      ctx.strokeStyle = 'white';
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(width / 2, 0);
      ctx.lineTo(width / 2, height);
      ctx.stroke();

      // Center circle
      ctx.beginPath();
      ctx.arc(width / 2, height / 2, 40, 0, Math.PI * 2);
      ctx.stroke();

      // Goals
      ctx.fillStyle = 'red';
      ctx.fillRect(0, height / 2 - 50, 10, 100); // Player goal
      ctx.fillRect(width - 10, height / 2 - 50, 10, 100); // AI goal
    }

    function drawPaddle(paddle, color) {
      ctx.beginPath();
      ctx.arc(paddle.x, paddle.y, paddle.radius, 0, Math.PI * 2);
      ctx.fillStyle = color;
      ctx.fill();
    }

    function drawPuck() {
      ctx.beginPath();
      ctx.arc(puck.x, puck.y, puck.radius, 0, Math.PI * 2);
      ctx.fillStyle = 'white';
      ctx.fill();
    }

    function update() {
      puck.x += puck.dx;
      puck.y += puck.dy;

      // Bounce off top and bottom
      if (puck.y - puck.radius < 0 || puck.y + puck.radius > height) {
        puck.dy *= -1;
        hitSound.play();
      }

      // Bounce off paddles
      const hitPlayer = Math.hypot(puck.x - player.x, puck.y - player.y) < puck.radius + player.radius;
      const hitAI = Math.hypot(puck.x - ai.x, puck.y - ai.y) < puck.radius + ai.radius;

      if (hitPlayer || hitAI) {
        puck.dx *= -1;
        hitSound.play();
      }

      // AI Movement
      if (puck.y < ai.y) ai.y -= 3;
      if (puck.y > ai.y) ai.y += 3;

      // Goal
      if (puck.x - puck.radius < 0) {
        aiScore++;
        goalSound.play();
        resetPuck();
      } else if (puck.x + puck.radius > width) {
        playerScore++;
        goalSound.play();
        resetPuck();
      }

      scoreboard.textContent = `Player: ${playerScore} | AI: ${aiScore}`;
    }

    function resetPuck() {
      puck.x = width / 2;
      puck.y = height / 2;
      puck.dx *= -1;
      puck.dy = 4 * (Math.random() > 0.5 ? 1 : -1);
    }

    function updateTimer() {
      if (gameTime > 0) {
        gameTime--;
        const mins = String(Math.floor(gameTime / 60)).padStart(2, '0');
        const secs = String(gameTime % 60).padStart(2, '0');
        timerDisplay.textContent = `Time: ${mins}:${secs}`;
      } else {
        clearInterval(gameLoop);
        clearInterval(timerInterval);
        timerDisplay.textContent = "Time: 00:00";
        alert(playerScore > aiScore ? "You Win!" : playerScore < aiScore ? "AI Wins!" : "Draw!");
      }
    }

    function draw() {
      drawBoard();
      drawPaddle(player, 'lime');
      drawPaddle(ai, 'orange');
      drawPuck();
    }

    function loop() {
      ctx.clearRect(0, 0, width, height);
      update();
      draw();
    }

    const gameLoop = setInterval(loop, 1000 / 60);
    const timerInterval = setInterval(updateTimer, 1000);
  </script>
</body>
</html>
